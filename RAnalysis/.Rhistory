exp2.resp.ph # view post hoc summary
E2.pairs.RESP.05 <- cld(exp2.resp.ph, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.RESP.05 #view results
# ANALYSIS
# Three-Way anova for respiration rate under Secondary OA Exposure
resp_EXP2_2.4.6.$Day <- as.character(resp_EXP2_2.4.6.$Day) # covert day to character
EXP2.resp.aov.mod <- aov(FINALresp ~ Init.treat*Sec.treat*Day, data = resp_EXP2_2.4.6.) # run anova on treatment and time
anova(EXP2.resp.aov.mod) # significant effect from day and marginal effect from secondary treatment
# Levene's test for homogeneity
leveneTest(EXP2.resp.aov.mod) # p 0.4541
# Shapiro test
EXP2.resp.mod.residuals <- residuals(object = EXP2.resp.aov.mod) # call residuals from the model
shapiro.test(x = EXP2.resp.mod.residuals) # 0.005096
#post-hoc
exp2.resp.ph <- lsmeans(EXP2.resp.aov.mod, pairwise ~ Init.treat*Sec.treat*Day)# pariwise Tukey Post-hoc test between repeated treatments
exp2.resp.ph # view post hoc summary
E2.pairs.RESP.05 <- cld(exp2.resp.ph, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.RESP.05 #view results
anova(EXP2.resp.aov.mod) # significant effect from day and marginal effect from secondary treatment
#post-hoc
exp2.resp.ph <- lsmeans(EXP2.resp.aov.mod, pairwise ~ Sec.treat)# pariwise Tukey Post-hoc test between repeated treatments
exp2.resp.ph # view post hoc summary
E2.pairs.RESP.05 <- cld(exp2.resp.ph, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.RESP.05 #view results
#post-hoc
exp2.resp.ph <- lsmeans(EXP2.resp.aov.mod, pairwise ~ Day)# pariwise Tukey Post-hoc test between repeated treatments
exp2.resp.ph # view post hoc summary
E2.pairs.RESP.05 <- cld(exp2.resp.ph, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.RESP.05 #view results
anova(EXP2.resp.aov.mod) # significant effect of time and marginal effect from secondary treatment
# Levene's test for homogeneity
leveneTest(EXP2.resp.aov.mod) # p 0.4541
# Shapiro test
EXP2.resp.mod.residuals <- residuals(object = EXP2.resp.aov.mod) # call residuals from the model
shapiro.test(x = EXP2.resp.mod.residuals) # 0.005096
#post-hoc
exp2.resp.ph <- lsmeans(EXP2.resp.aov.mod, pairwise ~ Day)# pariwise Tukey Post-hoc test between repeated treatments
exp2.resp.ph # view post hoc summary
E2.pairs.RESP.05 <- cld(exp2.resp.ph, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.RESP.05 #view results
exp2.resp.ph # view post hoc summary
E2.pairs.RESP.05 <- cld(exp2.resp.ph, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.RESP.05 #view results
E2.pairs.RESP.1 <- cld(exp2.resp.day, alpha=.1, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.RESP.1 #view results
#post-hoc for sig affect of time
exp2.resp.day <- lsmeans(EXP2.resp.aov.mod, pairwise ~ Day)# pariwise Tukey Post-hoc test between repeated treatments
exp2.resp.day # view post hoc summary
E2.pairs.RESP.05 <- cld(exp2.resp.day, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.RESP.05 #view results
E2.pairs.RESP.1 <- cld(exp2.resp.day, alpha=.1, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.RESP.1 #view results
# t-test for differences at the end of exp1 (day 10) and start of exp 2 (day 0) by treatment
exp1_d10.resp  <- subset(resp_EXP1, Date=="20180724") # starting resp  on Day 10 in Exp 1
t.test(exp1_d10.resp$FINALresp~exp1_d10.resp$Init.treat) # p-value = 0.08471; t-test shows no difference between treatment at the start of Exp2
exp2_d0.resp <- subset(resp_EXP2, Date=="20180807") # starting resp  on Day 0 in Exp 2
t.test(exp2_d0.resp$FINALresp~exp2_d0.resp$Init.treat) # p-value = 0.01469; t-test shows significant difference between treatment at the start of Exp2
# t-test for differences at the end of exp1 (day 10) and start of exp 2 (day 0) by treatment
exp1_d10.resp  <- subset(resp_EXP1, Date=="20180724") #  resp  on Day 10 in Exp 1
t.test(exp1_d10.resp$FINALresp~exp1_d10.resp$Init.treat) # p-value = 0.08471; t-test shows no difference between treatment at the start of Exp2
t.test(exp1_d10.resp$FINALresp~exp1_d10.resp$Init.treat) # p-value = 0.08471; t-test shows no difference between treatment at end of exp 1
exp2_d0.resp <- subset(resp_EXP2, Date=="20180807") # starting resp  on Day 0 in Exp 2
t.test(exp2_d0.resp$FINALresp~exp2_d0.resp$Init.treat) # p-value = 0.01469; t-test shows significant difference between treatment at the start of Exp2
# TEST FOR EFFECTS OF THE FOUR TREATMENT GROUPS  FOR ALL DAYS
# anovas for signifcant between treatments for all days in EXP2
Resp_EXP2_d2 <- subset(resp_EXP2, Day==2)
Resp_d2_EXP2 <- aov(FINALresp~Treat1_Treat2, data=Resp_EXP2_d2)
summary(Resp_d2_EXP2) # day 2 no difference between treatments
Resp_EXP2_d4 <- subset(resp_EXP2, Day==4)
Resp_d4_EXP2 <- aov(FINALresp~Treat1_Treat2, data=size_EXP2_d4)
summary(Resp_d4_EXP2) # day4 no difference between treatments
Resp_EXP2_d4 <- subset(resp_EXP2, Day==4)
Resp_d4_EXP2 <- aov(FINALresp~Treat1_Treat2, data=size_EXP2_d4)
Resp_EXP2_d4 <- subset(resp_EXP2, Day==4)
Resp_d4_EXP2 <- aov(FINALresp~Treat1_Treat2, data=Resp_EXP2_d4)
summary(Resp_d4_EXP2) # day4 no difference between treatments
Resp_EXP2_d6 <- subset(resp_EXP2, Day==6)
Resp_d6_EXP2 <- aov(FINALresp~Treat1_Treat2, data=Resp_EXP2_d6)
summary(Resp_d6_EXP2) # day 6 no difference between treatments
Resp_EXP2_ALL <- subset(resp_EXP2, Day!=0)
Resp_alldays_EXP2 <- aov(FINALresp~Treat1_Treat2, data=Resp_EXP2_ALL)
summary(Resp_alldays_EXP2) # ALL days no difference between treatments
summary(Resp_alldays_EXP2) # ALL days no difference between treatments
#Load Size Data
size<-read.csv("Data/All_growth_data.csv", header=T, sep=",", na.string="NA", as.is=T)
size <- tibble::rowid_to_column(size, "ID") # add unique rownumber column to ID animals
# CREATE DATASETS FOR EXPOSURES 1 AND 2
size_EXP1_with_PreExposure <- subset(size, Exp.Num=="Exp1") # all Exp1 data
size_EXP1 <- subset(size_EXP1_with_PreExposure, trial!="prebasal") # Exp1 without Day 0
size_EXP1_PreExposure <- subset(size_EXP1_with_PreExposure, Day=="prebasal") # Seperate Day 0 of Exp 1 for Figure
size_EXP1_PreExposure$Day <- "0" # name day as 0 (before it was "prebasal")
size_EXP1_all <- rbind(size_EXP1_PreExposure, size_EXP1) # merge two datasets for the first size figure Exp 1
size_EXP2 <- subset(size, Exp.Num=="Exp2") # all Exp 2
size_EXP2.d0 <- subset(size_EXP2, Day==0)
size_EXP2.0 <-subset(size_EXP2, Day!=0) # Exp 2 without day 0
size_Exp1.T<- merge(size_EXP1, size_EXP2, by=c("tank"))  #merge to obtained combined treatments from EXP2
inital_size <- subset(size_EXP1, Date=="20180716") # get starting size of indiivduals from first measurements
StartSize <- summarySE(inital_size, measurevar="shell_size", groupvars=c("Date")) #summary table for starting shell length = 5.077962 ± 0.6622871 (mean ± SD)
end_size <- subset(size_EXP1, Date=="20180724") # get the ned size on Day 10 of exposure 1
# plot end of exp 1 Day 10 with treatments
length_EXP1_Day10 <- ggplot(end_size, aes(x = treatment, y = shell_size, fill = treatment)) +
geom_boxplot(alpha = 0.1) + scale_color_grey() + scale_fill_grey() + theme_classic() +
ylim(2,8.2) +
geom_point(pch = 19, position = position_jitterdodge(0.1), size=1) +
#geom_point(aes(fill = treatment), size = 0.5, shape = 21, position = position_jitterdodge(0.05)) +
stat_summary(fun.y=mean, geom="point", pch="+", size=3, position = position_jitterdodge(0.01)) +
theme(legend.position = c(.92, .9), legend.text=element_text(size=8)) +
labs(y="shell length", x = "Treatment", fill="")
length_EXP1_Day10
### EXP1 ####
#plot treatments and time (with prePreExposure)
Exp1.Fig.size <- ggplot(size_EXP1_all, aes(x = factor(Day), y = shell_size, fill = treatment)) +
geom_boxplot(alpha = 0.1, width=0.8) +
scale_color_grey() + scale_fill_grey() + theme_classic() +
ylim(2,8.2) + scale_x_discrete(limits=c("0",2,5,8,10)) +
geom_point(pch = 19, position = position_jitterdodge(0.1), size=.5) +
#geom_point(aes(fill = treatment), size = 0.5, shape = 21, position = position_jitterdodge(0.05)) +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.8, size=0.6, linetype = "dashed", position = position_jitterdodge(0.01)) +
theme(legend.position = c(0.9,0.9)) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1)+
labs(y=expression("Shell length"~(mm)), x=expression("Time"~(days)))
Exp1.Fig.size_FINAL <- Exp1.Fig.size + scale_fill_manual(values=c("white", "grey3"), labels=c("Ambient","Elevated"))
Exp1.Fig.size_FINAL
# Two-Way anova for shell size under Initial OA Exposure
EXP1.size.aov.mod <- aov(shell_size ~ Init.Trt * Day, data = size_EXP1) # run anova on treatment and time
anova(EXP1.size.aov.mod) # significant effect of time; no effect from treatment
# Two-Way anova for shell size under Initial OA Exposure
EXP1.size.aov.mod <- aov(shell_size ~ Init.Trt * Day, data = size_EXP1) # run anova on treatment and time
anova(EXP1.size.aov.mod) # significant effect of time; no effect from treatment
# Levene's test for homogeneity
leveneTest(EXP1.size.aov.mod) # p 0.5609
# plot the residuals
par(mfrow=c(1,3)) #set plotting configuration
par(mar=c(1,1,1,1)) #set margins for plots
hist(residuals(EXP1.size.aov.mod)) #plot histogram of residuals
boxplot(residuals(EXP1.size.aov.mod)) #plot boxplot of residuals
plot(fitted(EXP1.size.aov.mod),residuals(EXP1.size.aov.mod))
### EXP2 ####
#PLOTTING
Exp2.Fig.size <- ggplot(size_ALL_fig, aes(x = factor(Day), y = shell_size, fill = Treat1_Treat2)) +
geom_boxplot(alpha = 0.1, width=0.8) +
scale_color_grey() + scale_fill_grey(start = 0, end = 0.9) + theme_classic() +
geom_point(pch = 19, position = position_jitterdodge(0.01), size=0.5) +
ylim(2, 8.2) +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.8, size=0.6, linetype = "dashed", position = position_jitterdodge(0.01)) +
theme(legend.position = c(0.9,0.9)) +
scale_x_discrete(labels = c("0",2,4,6)) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
labs(y=expression("Shell size"~(mm)), x=expression("Time"~(days)))
Exp2.Fig.size_FINAL <- Exp2.Fig.size + scale_fill_manual(values=c("white", "white", "grey80", "grey3", "gray50", "grey3"),
labels=c("Ambient","Ambient × Ambient","Ambient × Elevated","Elevated","Elevated × Ambient","Elevated × Elevated"))
Exp2.Fig.size_FINAL
size_ALL_fig
### EXP2 ####
#PLOTTING
Exp2.Fig.size <- ggplot(size_ALL_fig, aes(x = factor(Day), y = shell_size, fill = Treat1_Treat2)) +
geom_boxplot(alpha = 0.1, width=0.8) +
scale_color_grey() + scale_fill_grey(start = 0, end = 0.9) + theme_classic() +
geom_point(pch = 19, position = position_jitterdodge(0.01), size=0.5) +
ylim(2, 8.2) +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.8, size=0.6, linetype = "dashed", position = position_jitterdodge(0.01)) +
theme(legend.position = c(0.9,0.9)) +
scale_x_discrete(labels = c("0",2,4,6)) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
labs(y=expression("Shell size"~(mm)), x=expression("Time"~(days)))
Exp2.Fig.size_FINAL <- Exp2.Fig.size + scale_fill_manual(values=c("white", "white", "grey80", "grey3", "gray50", "grey3"),
labels=c("Ambient","Ambient × Ambient","Ambient × Elevated","Elevated","Elevated × Ambient","Elevated × Elevated"))
Exp2.Fig.size_FINAL
### EXP1 ####
#plot treatments and time (with prePreExposure)
Exp1.Fig.size <- ggplot(size_EXP1_all, aes(x = factor(Day), y = shell_size, fill = treatment)) +
geom_boxplot(alpha = 0.1, width=0.8) +
scale_color_grey() + scale_fill_grey() + theme_classic() +
ylim(2,8.2) + scale_x_discrete(limits=c("0",2,5,8,10)) +
geom_point(pch = 19, position = position_jitterdodge(0.1), size=.5) +
#geom_point(aes(fill = treatment), size = 0.5, shape = 21, position = position_jitterdodge(0.05)) +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.8, size=0.6, linetype = "dashed", position = position_jitterdodge(0.01)) +
theme(legend.position = c(0.9,0.9)) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1)+
labs(y=expression("Shell length"~(mm)), x=expression("Time"~(days)))
Exp1.Fig.size_FINAL <- Exp1.Fig.size + scale_fill_manual(values=c("white", "grey3"), labels=c("Ambient","Elevated"))
Exp1.Fig.size_FINAL
### EXP1 ####
#plot treatments and time (with prePreExposure)
Exp1.Fig.size.A <- ggplot(size_EXP1_all, aes(x = factor(Day), y = shell_size, fill = treatment)) +
theme_classic() +
scale_fill_manual(values=c("white", "grey3"), labels=c("Ambient","Elevated")) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19, position = position_jitterdodge(.05), size=1) +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.6, size=0.4, linetype = "dashed", position = position_dodge(preserve = "single")) +
theme(legend.position = c(0.55,0.96), legend.direction="horizontal", legend.title=element_blank()) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
ylim(2,8.2) +
scale_x_discrete(limits=c("0",2,5,8,10)) +
labs(y=expression("Shell length"~(mm)), x=expression("Days"))
Exp1.Fig.size.B <- Exp1.Fig.size.A +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.text.y = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.line = element_line(color = 'black'),
axis.ticks.length=unit(0.2, "cm"),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14)) +
scale_y_continuous(limits = c(2, 8), expand = c(0, 0))
Exp1.Fig.size.B # view the plot
Exp1.Fig.size_FINAL <-
Exp1.Fig.size.B +
geom_segment(aes(x = 1.6, y = 7.3, xend = 2.4, yend = 7.3)) +
geom_segment(aes(x = 2.6, y = 7.3, xend = 3.4, yend = 7.3)) +
geom_segment(aes(x = 3.6, y = 7.3, xend = 4.4, yend = 7.3)) +
geom_segment(aes(x = 4.6, y = 7.3, xend = 5.4, yend = 7.3)) +
annotate("text", x="2", y=7.2, label = "a", size = 4) + # t-test with p < 0.05 between treatments at day 0
annotate("text", x="5", y=7.2, label = "ab", size = 4) + # add text to the graphic for posthoc letters - effect of time
annotate("text", x="8", y=7.2, label = "ab", size = 4) + # add text to the graphic for posthoc letters - effect of time
annotate("text", x="10", y=7.2, label = "b", size = 4) # add text to the graphic for posthoc letters - effect of time
Exp1.Fig.size_FINAL
# Two-Way anova for shell size under Initial OA Exposure
EXP1.size.aov.mod <- aov(shell_size ~ Init.Trt * Day, data = size_EXP1) # run anova on treatment and time
anova(EXP1.size.aov.mod) # significant effect of time; no effect from treatment
# post-hoc
exp1.size.ph <- lsmeans(EXP1.size.aov.mod, pairwise ~  Day)# pariwise Tukey Post-hoc test between repeated treatments
exp1.size.ph # view post hoc summary
E1.pairs.SIZE.05 <- cld(exp1.size.ph, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E1.pairs.SIZE.05 #view results
# CREATE DATASETS FOR EXPOSURES 1 AND 2
size_EXP1_with_PreExposure <- subset(size, Exp.Num=="Exp1") # all Exp1 data
size_EXP1 <- subset(size_EXP1_with_PreExposure, trial!="prebasal") # Exp1 without Day 0
size_EXP1_PreExposure <- subset(size_EXP1_with_PreExposure, Day=="prebasal") # Seperate Day 0 of Exp 1 for Figure
size_EXP1_PreExposure$Day <- "0" # name day as 0 (before it was "prebasal")
size_EXP1_all <- rbind(size_EXP1_PreExposure, size_EXP1) # merge two datasets for the first size figure Exp 1
size_EXP2 <- subset(size, Exp.Num=="Exp2") # all Exp 2
size_EXP2.d0 <- subset(size_EXP2, Day==0)
size_EXP2.d0$Treat1_Treat2 <- size_EXP2.d0$Init.Trt # merge column or initial treat as treat1_treat2 for Exp2 figure
size_EXP2.0 <-subset(size_EXP2, Day!=0) # Exp 2 without day 0
size_EXP2_all <- rbind(size_EXP2.d0, size_EXP2.0) # merge two datasets for the first size figure Exp 2
size_Exp1.T<- merge(size_EXP1, size_EXP2, by=c("tank"))  #merge to obtained combined treatments from EXP2
inital_size <- subset(size_EXP1, Date=="20180716") # get starting size of indiivduals from first measurements
StartSize <- summarySE(inital_size, measurevar="shell_size", groupvars=c("Date")) #summary table for starting shell length = 5.077962 ± 0.6622871 (mean ± SD)
end_size <- subset(size_EXP1, Date=="20180724") # view the efinal size on Day 10 of exposure 1
# plot end of exp 1 Day 10 with treatments
length_EXP1_Day10 <- ggplot(end_size, aes(x = treatment, y = shell_size, fill = treatment)) +
geom_boxplot(alpha = 0.1) + scale_color_grey() + scale_fill_grey() + theme_classic() +
ylim(2,8.2) +
geom_point(pch = 19, position = position_jitterdodge(0.1), size=1) +
#geom_point(aes(fill = treatment), size = 0.5, shape = 21, position = position_jitterdodge(0.05)) +
stat_summary(fun.y=mean, geom="point", pch="+", size=3, position = position_jitterdodge(0.01)) +
theme(legend.position = c(.92, .9), legend.text=element_text(size=8)) +
labs(y="shell length", x = "Treatment", fill="")
length_EXP1_Day10
### EXP1 ####
#plot treatments and time (with prePreExposure)
Exp1.Fig.size.A <- ggplot(size_EXP1_all, aes(x = factor(Day), y = shell_size, fill = treatment)) +
theme_classic() +
scale_fill_manual(values=c("white", "grey3"), labels=c("Ambient","Elevated")) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19, position = position_jitterdodge(.05), size=1) +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.6, size=0.4, linetype = "dashed", position = position_dodge(preserve = "single")) +
theme(legend.position = c(0.55,0.96), legend.direction="horizontal", legend.title=element_blank()) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
ylim(2,8.2) +
scale_x_discrete(limits=c("0",2,5,8,10)) +
labs(y=expression("Shell length"~(mm)), x=expression("Days"))
Exp1.Fig.size.B <- Exp1.Fig.size.A +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.text.y = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.line = element_line(color = 'black'),
axis.ticks.length=unit(0.2, "cm"),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14)) +
scale_y_continuous(limits = c(2, 8), expand = c(0, 0))
Exp1.Fig.size.B # view the plot
# Two-Way anova for shell size under Initial OA Exposure
EXP1.size.aov.mod <- aov(shell_size ~ Init.Trt * Day, data = size_EXP1) # run anova on treatment and time
anova(EXP1.size.aov.mod) # significant effect of time; no effect from treatment
# Levene's test for homogeneity
leveneTest(EXP1.size.aov.mod) # p 0.5609
# post-hoc
exp1.size.ph <- lsmeans(EXP1.size.aov.mod, pairwise ~  Day)# pariwise Tukey Post-hoc test between repeated treatments
exp1.size.ph # view post hoc summary
E1.pairs.SIZE.05 <- cld(exp1.size.ph, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E1.pairs.SIZE.05 #view results
# plot the residuals
par(mfrow=c(1,3)) #set plotting configuration
par(mar=c(1,1,1,1)) #set margins for plots
hist(residuals(EXP1.size.aov.mod)) #plot histogram of residuals
boxplot(residuals(EXP1.size.aov.mod)) #plot boxplot of residuals
plot(fitted(EXP1.size.aov.mod),residuals(EXP1.size.aov.mod))
Exp1.Fig.size_FINAL <-
Exp1.Fig.size.B +
geom_segment(aes(x = 1.6, y = 7.3, xend = 2.4, yend = 7.3)) +
geom_segment(aes(x = 2.6, y = 7.3, xend = 3.4, yend = 7.3)) +
geom_segment(aes(x = 3.6, y = 7.3, xend = 4.4, yend = 7.3)) +
geom_segment(aes(x = 4.6, y = 7.3, xend = 5.4, yend = 7.3)) +
annotate("text", x="2", y=7.2, label = "a", size = 4) + # t-test with p < 0.05 between treatments at day 0
annotate("text", x="5", y=7.2, label = "ab", size = 4) + # add text to the graphic for posthoc letters - effect of time
annotate("text", x="8", y=7.2, label = "ab", size = 4) + # add text to the graphic for posthoc letters - effect of time
annotate("text", x="10", y=7.2, label = "b", size = 4) # add text to the graphic for posthoc letters - effect of time
Exp1.Fig.size_FINAL
### EXP2 ####
#PLOTTING
Exp2.Fig.size <- ggplot(size_ALL_fig, aes(x = factor(Day), y = shell_size, fill = Treat1_Treat2)) +
geom_boxplot(alpha = 0.1, width=0.8) +
scale_color_grey() + scale_fill_grey(start = 0, end = 0.9) + theme_classic() +
geom_point(pch = 19, position = position_jitterdodge(0.01), size=0.5) +
ylim(2, 8.2) +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.8, size=0.6, linetype = "dashed", position = position_jitterdodge(0.01)) +
theme(legend.position = c(0.9,0.9)) +
scale_x_discrete(labels = c("0",2,4,6)) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
labs(y=expression("Shell size"~(mm)), x=expression("Time"~(days)))
### EXP2 ####
#PLOTTING
Exp2.Fig.size.A <- ggplot(size_EXP2_all, aes(x = factor(Day), y = shell_size, fill = Treat1_Treat2)) +
theme_classic() +
scale_fill_manual(values=c("white", "white", "grey80", "grey3", "gray50", "grey3"),
labels=c("Ambient","Ambient × Ambient","Ambient × Elevated","Elevated","Elevated × Ambient","Elevated × Elevated")) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19, position = position_jitterdodge(.05), size=1) +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.6, size=0.4, linetype = "dashed", position = position_dodge(preserve = "single")) +
theme(legend.position = c(0.55,0.96), legend.direction="horizontal", legend.title=element_blank()) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
ylim(2,8.2) +
scale_x_discrete(labels = c("0",2,4,6)) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
labs(y=expression("Shell size"~(mm)), x=expression("Days"))
Exp2.Fig.size.FINAL <- Exp2.Fig.size.A  +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.text.y = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.line = element_line(color = 'black'),
axis.ticks.length=unit(0.2, "cm"),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14)) +
scale_y_continuous(limits = c(2, 8), expand = c(0, 0))
Exp2.Fig.size.FINAL # view the plot
# ANALYSIS
# t-test for differences at the end of exp1 (day 10) and start of exp 2 (day 0) by treatment
exp1_d10.size <- subset(size_EXP1, Date=="20180724") # starting size on Day 10 in Exp 1
t.test(exp1_d10.size$shell_size~exp1_d10.size$Init.Trt) # p-value = 0.6083; t-test shows no difference between treatment at the start of Exp2
exp2_d0.size <- subset(size_EXP2, Date=="20180807") # starting size on Day 0 in Exp 2
t.test(exp2_d0.size$shell_size~exp2_d0.size$Init.Trt) # p-value = 0.2531; t-test shows significant difference between treatment at the start of Exp2
# Three-Way anova for shell size under Secondary OA Exposure
EXP2.size.aov.mod <- aov(shell_size ~ Init.Trt*Sec.Trt* Day, data = size_EXP2.0) # run anova on treatment and time
anova(EXP2.size.aov.mod) # significant effect fromboth inital and secondary treatment
# Levene's test for homogeneity
leveneTest(EXP2.size.aov.mod) # p 0.8418
# plot the residuals
par(mfrow=c(1,3)) #set plotting configuration
par(mar=c(1,1,1,1)) #set margins for plots
hist(residuals(EXP2.size.aov.mod)) #plot histogram of residuals
boxplot(residuals(EXP2.size.aov.mod)) #plot boxplot of residuals
plot(fitted(EXP2.size.aov.mod),residuals(EXP2.size.aov.mod))
# post-hoc
exp2.size.ph <- lsmeans(EXP2.size.aov.mod, pairwise ~  Init.Trt*Sec.Trt* Day)# pariwise Tukey Post-hoc test between repeated treatments
exp2.size.ph # view post hoc summary
# Levene's test for homogeneity
leveneTest(EXP2.size.aov.mod) # p 0.8418
# post-hoc
exp2.size.ph <- lsmeans(EXP2.size.aov.mod, pairwise ~  Init.Trt*Sec.Trt* Day)# pariwise Tukey Post-hoc test between repeated treatments
exp2.size.ph # view post hoc summary
E2.pairs.SIZE.05 <- cld(exp2.size.ph, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.SIZE.05 #view results
# effect of initial exposure
exp2.size.ph.initial <- lsmeans(EXP2.size.aov.mod, pairwise ~  Init.Trt)# pariwise Tukey Post-hoc test between repeated treatments
exp2.size.ph.initial # view post hoc summary
E2.pairs.SIZE.05.initial <- cld(exp2.size.ph.initial, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.SIZE.05.initial #view results
# effect of initial exposure
exp2.size.ph.sec <- lsmeans(EXP2.size.aov.mod, pairwise ~  Sec.Trt)# pariwise Tukey Post-hoc test between repeated treatments
exp2.size.ph.sec  # view post hoc summary
E2.pairs.SIZE.05.sec <- cld(exp2.size.ph.sec, alpha=.05, Letters=letters) #list pairwise tests and letter display p < 0.05
E2.pairs.SIZE.05.sec #view results
# effect of initial exposure
exp2.size.ph.initial <- lsmeans(EXP2.size.aov.mod, pairwise ~  Init.Trt)# pariwise Tukey Post-hoc test between repeated treatments
exp2.size.ph.initial # view post hoc summary
exp2.size.ph.initial
exp2.size.ph.sec
exp2.size.ph.sec[1,2]
exp2.size.ph.sec[1]
exp2.size.ph.sec[2]
exp2.size.ph.sec([1]c(1,2))
exp2.size.ph.sec[1]
too <- exp2.size.ph.sec[1]
too[2,2]
too[2]
too[3]
too[1,2]
too
too$lsmean
too$SE
too <- as.table(exp2.size.ph.sec[1])
exp2.size.ph.sec  # view post hoc summary
EXP2_perc_diff_SecTrmt <- ((5.796007 - 5.610461) / (5.796007)) *100
EXP2_perc_diff_SecTrmt
# effect of initial exposure
exp2.size.ph.initial <- lsmeans(EXP2.size.aov.mod, pairwise ~  Init.Trt)# pariwise Tukey Post-hoc test between repeated treatments
exp2.size.ph.initial # view post hoc summary
EXP2_perc_diff_InitTrmt <- ((5.820324 - 5.586145) / (5.820324)) *100
EXP2_perc_diff_InitTrmt
# PLOTTING
resp_EXP2_d0$Treat1_Treat2 <- resp_EXP2_d0$Init.treat # Day 0 in Exp2 still has potential carry over from 2 treatments in intial exp, not 4 treatments in Exp2
resp_EXP2_merge <- rbind(resp_EXP2_d0, resp_EXP2_2.4.6.) # merge the two tables for the graph
#plot treatments and time (PreExposure added as day 0 data)
Exp2.Fig.resp.A <- ggplot(resp_EXP2_merge, aes(x = factor(resp_EXP2_merge$Day), y = resp_EXP2_merge$FINALresp, fill = resp_EXP2_merge$Treat1_Treat2)) +
scale_fill_manual(values=c("white", "white", "grey80", "gray1", "gray50", "gray1"),
labels=c("Ambient","Ambient × Ambient","Ambient × Elevated","Elevated","Elevated × Ambient","Elevated × Elevated")) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0, # make outliers small
position = position_dodge(preserve = "single")) +
geom_point(pch = 19, position = position_jitterdodge(0.01), size=1) +
theme_classic() + ylim(0, 0.6) +
#geom_point(aes(fill = resp_EXP2$Treat1_Treat2), size = 1.5, shape = 21, position = position_jitterdodge(0.05)) +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.6, size=0.4, linetype = "dashed", position = position_dodge(preserve = "single")) +
theme(legend.position = c(0.55,0.96), legend.direction="horizontal", legend.title=element_blank()) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
scale_x_discrete(labels = c("0",2,4,6)) +
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
labs(y=expression("Respiration rate"~(~µg~O[2]*hr^{-1}*indiv^{-1})), x=expression("Days"), fill="")
Exp2.Fig.resp.A # view the plot
Exp2.Fig.resp.B <-
Exp2.Fig.resp.A +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.text.y = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.line = element_line(color = 'black'),
axis.ticks.length=unit(0.2, "cm"),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14)) +
scale_y_continuous(limits = c(0, 0.65), expand = c(0, 0))
Exp2.Fig.resp.B # view the plot
#ADD MODEL RESULTS TO THE PLOT
Exp2.Fig.resp_FINAL <-
Exp2.Fig.resp.B +
geom_segment(aes(x = 1.6, y = 0.55, xend = 2.4, yend = 0.55)) +
geom_segment(aes(x = 2.6, y = 0.55, xend = 3.4, yend = 0.55)) +
geom_segment(aes(x = 3.6, y = 0.55, xend = 4.4, yend = 0.55)) +
geom_segment(aes(x = .6, y = 0.55, xend = 1.4, yend = 0.55)) +
annotate("text", x="0", y=0.54, label = "**", size = 4) + # t-test with p < 0.05 between treatments at day 0
annotate("text", x="2", y=0.54, label = "*a", size = 4) + # add text to the graphic for posthoc letters - effect of time
annotate("text", x="4", y=0.54, label = "*ab", size = 4) + # add text to the graphic for posthoc letters - effect of time
annotate("text", x="6", y=0.54, label = "*b", size = 4) # add text to the graphic for posthoc letters - effect of time
Exp2.Fig.resp_FINAL
#plot by exp 1 by treatment
Exp1.Fig.resp.A <- ggplot(resp_EXP1_ALL, aes(x = factor(resp_EXP1_ALL$Day),
y = resp_EXP1_ALL$FINALresp,
fill = resp_EXP1_ALL$Init.treat)) +
scale_fill_manual(values=c("white","gray1"),
labels=c("Ambient","Elevated")) +
geom_boxplot(alpha = 0.5, # color hue
width=0.6, # boxplot width
outlier.size=0,
position = position_dodge(preserve = "single")) +
geom_point(pch = 19, position = position_jitterdodge(0.01), size=1) +
theme_classic() +
stat_summary(fun.y=mean, geom = "errorbar", aes(ymax = ..y.., ymin = ..y..),
width = 0.6, size=0.4, linetype = "dashed", position = position_dodge(preserve = "single")) +
theme(legend.position = c(0.55,0.9),legend.direction="horizontal", legend.title=element_blank(),
axis.line = element_line(color = 'black'), #Set the axes color
axis.ticks.length=unit(0.2, "cm")) + #turn ticks inward
geom_vline(xintercept=c(1.5), linetype="dotted", size=1) +
scale_x_discrete(labels = c("0",2,5,8,10))    +
labs(y=expression("Respiration rate"~(~µg~O[2]*hr^{-1}*mm^{-1})), x=expression("Days"),fill= "")
Exp1.Fig.resp.B <- Exp1.Fig.resp.A + theme(axis.text.x = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.text.y = element_text(angle = 0, hjust = 0.5, size=13,color="black"),
axis.line = element_line(color = 'black'),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14))
Exp1.Fig.resp_FINAL <-  Exp1.Fig.resp.B + scale_y_continuous(limits = c(0, 0.65), expand = c(0, 0))
Exp1.Fig.resp_FINAL
Exp2.Fig.resp_FINAL
Exp1.Fig.size_FINAL
Exp2.Fig.size.FINAL # view the plot
# Assemble output plots
figure_1 <- ggarrange(Exp1.Fig.resp_FINAL, Exp2.Fig.resp_FINAL,
labels = c("A) Respiration rate Exposure 1", "B) Respiration rate Exposure 2",
ncol = 2, nrow = 1))
figure_2 <- ggarrange(Exp1.Fig.size_FINAL, Exp2.Fig.size_FINAL,
labels = c("A) Shell size Exposure 1", "B) Shell size Exposure 2",
ncol = 2, nrow = 1))
figure_1
figure_2
figure_2 <- ggarrange(Exp1.Fig.size_FINAL, Exp2.Fig.size_FINAL,
labels = c("A) Shell size Exposure 1", "B) Shell size Exposure 2",
ncol = 2, nrow = 1))
figure_2
# Assemble output plots
figure_1 <- ggarrange(Exp1.Fig.resp_FINAL, Exp2.Fig.resp_FINAL,
ncol = 1, nrow = 2)
figure_1 # view the figure
figure_2 <- ggarrange(Exp1.Fig.size_FINAL, Exp2.Fig.size.FINAL,
ncol = 1, nrow = 2)
figure_2 # view the figure
# Saving output plots
ggsave(file="Output/Supplem.Fig.conical.pH.temp.pdf", Supplem.Fig.conical.pH.temp, width = 12, height = 8, units = c("in"))
ggsave(file="Output/Output_Figure_1.pdf", figure_1, width = 12, height = 8, units = c("in"))
ggsave(file="Output/Output_Figure_2.pdf", figure_2, width = 12, height = 8, units = c("in"))
